<!doctype html>
<html lang="en">

<head>
    <title>Title</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS v5.2.0-beta1 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css"
          integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <style>
        #collection {
            bottom: 5%;
            right: 5%;
        }
    </style>
</head>

<body>
    <div class="container-lg" id="Clinic">


        <!-- 下拉選取 -->
        <div class="container">
            <div class="row justify-content-evenly">
                <select class=" col-5  form-select-sm mt-3 " aria-label="form-select-sm example" v-on:change="Getdata">
                    <option selected disabled>地區</option>
                    <option v-bind:value="item" v-for="item in City" v-on:change="Getdata">{{item}}</option>
                </select>
                 <select class=" col-5  form-select-sm mt-3 " aria-label="form-select-sm example" v-on:change="Getdata">
                    <option selected disabled>地區</option>
                    <option v-bind:value="item" v-for="item in City" v-on:change="Getdata">{{item}}</option>
                </select>
            </div>
        </div>

        <!-- 卡片 -->
        <div class="container" v-show="show">
            <div class="row " v-for="item in ClinicList">

                <div class="card mt-4" style="padding-left: 0px;padding-right: 0px">
                    <div class="row g-0">
                        <div class="col-md-8">
                            <div class="card-body" >
                                <h1>{{item.clinicName}}</h1>
                                <p class="card-text">電話號碼:{{item.phone}}</p>
                                <p class="card-text"><small class="text-muted">地址:{{item.address}}</small></p>
                                <small>有無急診:{{item.emergency}}</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="position-relative">
                                <img src="https://picsum.photos/id/682/600/400" class="w-100 rounded" alt="">
                                <button class="position-absolute  btn btn-outline-danger rounded-pill" id="collection">收藏</button>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>



</body>

@section Scripts{

    <script>
        var app = new Vue({
            data: {
                ClinicList: [],
                City: [],
                show: false

            },
            mounted: function() {       //頁面渲染之前執行
                fetch('/api/ClinicAPI/GetCity').then(res => {
                    return res.json();
                }).then(res => {
                    console.log('抓到', res)
                    this.City = res
                    console.log(this);
                });
                fetch('/api/ClinicAPI/GetAll').then(res => { //網頁打開頁面顯示最初內容
                    return res.json();
                }).then(res => {
                    console.log('抓到all', res)
                    this.ClinicList = res
                    this.show = true;
                    console.log(this);

                })
            },
            methods: {
                Getdata: function(e) {
                    console.log(e.target.value);
                    let self = this;
                    var addr = e.target.value;
                    fetch('/api/ClinicAPI/GetContent/' + addr, {
                        method: 'GET',
                    })
                        .then(function(res) {
                            return res.json();
                        }).then(function(d) {
                            console.log(d);
                            console.log(this);
                            self.ClinicList = d;

                        }).catch(error => console.log(error))
                }
            }
        }).$mount("#Clinic")


    </script>
}

    </html>