@model PetsWebsite.Models.Product
@*修改商品頁面*@
<div class="contanier m-5">
    <form id="editProductForm" action="@Url.Action("SaveEditedProduct", "Owner")" method="post" enctype="multipart/form-data">
        <div class="row align-items-center justify-content-center" style="height: 200px;">
            <div class="col col-6">
                <div class="row g-3 bg-light rounded mb-3">
                    <div class="col col-12">
                        <label for="ProductId" class="form-label">商品ID: </label>
                        <input type="text" value="@Model.ProductId" class="form-control" id="ProductId" name="ProductId" disabled>
                    </div>
                    <div class="col col-6 was-validated">
                        <label for="ProductName" class="form-label">商品名稱: </label>
                        <input type="text" value="@Model.ProductName" class="form-control is-invalid" id="ProductName" name="ProductName" required>
                    </div>
                    <div class="col col-6 was-validated">
                        <label for="UnitPrice" class="form-label">商品單價: </label>
                        <input type="text" value="@Model.UnitPrice" class="form-control is-invalid" id="UnitPrice" name="UnitPrice" required>
                    </div>
                    <div class="col col-6">
                        <label for="Discount">商品折扣: </label>
                        <input type="text" value="" class="form-control" id="Discount" name="Discount">
                    </div>
                    <div class="col col-6">
                        <label for="UnitsInStock">商品庫存: </label>
                        <input type="text" value="@Model.UnitsInStock" class="form-control" id="UnitsInStock" name="UnitsInStock">
                    </div>
                    <div class="col col-12">
                        <label for="Describe">商品描述: </label>
                        <textarea class="form-control" id="Describe" name="Describe" rows="3">@Model.Describe</textarea>
                    </div>
                    <div class="col col-12">
                        <label class="d-block" for="">圖片(大小請勿超過2MB)</label>
                        <div class="mb-3">
                            <input class="form-control" type="file" id="PhotoPath" name="PhotoPath" onchange="previewPic(this)" accept="image/*">
                            <img id="pic" src="/images/Product/@Model.PhotoPath" style="width: 30%; height: 30%" />
                        </div>
                    </div>
                    <hr class="mb-0">
                    <div class="col col-12 d-flex my-3 justify-content-center">
                        <button class="btn btn-outline-danger" type="submit">確認修改</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

<script>

$('#editProductForm').submit(function(e) {
    e.preventDefault();
    var formdata = new FormData(this);
    $.ajax({
        url: "/Owner/SaveEditedProduct/" + @Model.ProductId,
        type: "POST",
        data: formdata,
        async: false,
        cache: false,
        contentType: false,
        enctype: "multipart/form-data",
        processData: false
    }).done(function(resp) {
        console.log("resp: ", resp)
    }).fail(function(err) {
        console.log("err: ", err)
    })

})

    function previewPic(e) {
        //var pic = document.getElementById('pic');
        var maxSize_2MB = 1 * 1024 * 1024;
        if (e.files[0].maxSize_2MB > maxSize_2MB) {
            alert('圖片大小超過2MB！無法上傳');
            e.value = "";
        }
        else {
            pic.src = URL.createObjectURL(e.files[0])
        }
    }
</script>